function cargarCursos(){mostrarIndicadorCarga(!0),fetch("../model/get_courses.php").then((e=>e.json())).then((e=>{mostrarIndicadorCarga(!1),renderCursos(e)})).catch((e=>{mostrarIndicadorCarga(!1),mostrarMensajeError("Error fetching courses:",e)}))}function mostrarIndicadorCarga(e){document.getElementById("indicador-carga").style.display=e?"block":"none"}function mostrarMensajeError(e,n){document.getElementById("error-container").textContent=e,console.error(n)}function renderCursos(e){const n=document.getElementById("cursos-container"),o=document.getElementById("curso-template").innerHTML;n.innerHTML="",e.forEach((e=>{const t=document.createElement("div");t.innerHTML=o.replace(/{curso_id}/g,e.curso_id);const c=t.firstElementChild;c.querySelector(".titulo-curso").textContent=e.titulo_curso,c.querySelector(".descripcion-curso").textContent=e.descripcion,c.querySelector(".ver-lecciones-link").href=`../controller/controlador.php?seccion=seccion7&curso_id=${e.curso_id}`,obtenerInteracciones(e.curso_id,c),n.appendChild(c)}))}function obtenerInteracciones(e,n){fetch(`../model/get_interacion.php?curso_id=${e}`).then((e=>e.json())).then((e=>{n.querySelector(".like-count").textContent=`aprovado: ${e.like}`,n.querySelector(".dislike-count").textContent=`desaprovado: ${e.dislike}`})).catch((e=>console.error("Error fetching interactions:",e)))}function cargarLecciones(e){fetch(`../model/get_lessons.php?curso_id=${e}`).then((e=>e.json())).then((e=>{const n=document.getElementById("lecciones-container");n.innerHTML="",e.forEach((e=>{const o=document.createElement("div");o.className="leccion";const t=document.createElement("h2");t.textContent=e.titulo_leccion;const c=document.createElement("p");c.textContent=e.contenido;const r=document.createElement("p");r.textContent=`Fecha: ${e.fecha_registro}`,o.appendChild(t),o.appendChild(c),o.appendChild(r),n.appendChild(o)}))})).catch((e=>{console.error("Error fetching lessons:",e)}))}function agregarLeccion(){const e=document.getElementById("lecciones"),n='\n        <div class="col-md-12 mt-3">\n            <div class="bg-dark p-3 rounded">\n                <div class="form-group mb-3">\n                    <label for="titulo_leccion" class="form-label">Título de la lección</label>\n                    <input type="text" class="form-control" name="titulo_leccion[]" placeholder="Título de la lección" required>\n                </div>\n                <div class="form-group mb-3">\n                    <label for="contenido_leccion" class="form-label">Descripción</label>\n                    <textarea class="form-control" name="contenido_leccion[]" placeholder="Descripción" required></textarea>\n                </div>\n                <div class="form-group mb-3">\n                    <label for="archivo_leccion" class="form-label">Archivo de la lección</label>\n                    <input type="file" class="form-control" name="archivo_leccion[]" required>\n                </div>\n                <button type="button" class="btn btn-danger" onclick="eliminarLeccion(this)">Eliminar lección</button>\n            </div>\n        </div>\n    ',o=document.createElement("div");o.innerHTML=n.trim(),e.appendChild(o.firstChild)}function eliminarLeccion(e){document.getElementById("lecciones").removeChild(e.closest(".col-md-12"))}document.addEventListener("DOMContentLoaded",(function(){cargarCursos();const e=document.getElementById("form-busqueda");e.addEventListener("submit",(function(n){n.preventDefault();const o=new FormData(e),t=new URLSearchParams(o).toString();fetch(`../model/buscar.php?${t}`).then((e=>e.json())).then((e=>{renderCursos(e)})).catch((e=>{console.error("Error fetching courses:",e)}))}))}));